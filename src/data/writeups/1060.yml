title: QuadRSAtic
id: 1060
category: Crypto
difficulty: Beginner
content: |
  **Author**: Abhishek Bharadwaj

  Here we were given with a quadratic equation
  $$
  x^2 - b*x + n^2 = 0 \\
  b^2 - 4ac > 0\\ 
  $$
  it's a perfect square which states that our roots are *perfect squares*,here  `p^2,q^2` are the roots of the quadratic equation.

  if a,b are roots of an quadratic equation then the quadratic equation will be `x^2-(a+b)*x+a*b=0`.


  **solving for p,q** :
  Note:
  $$
      n =p*q \\
      n**2 = p^2 * q^2\\
      b = (p^2 + q^2) \\
      (p-q)^2 = b - 2*(p*q) \\
      (p+q)^2 = (p-q)^2 + 4*p*q \\\
  $$
  As we have p+q,p-q we can get p,q	
  #### Exploit
  ```python=
  from Crypto.Util.number import *
  from gmpy2 import *
  Sum = iroot(b+(2*n),2)[0]
  Diff = iroot(b-(2*n),2)[0]
  p = (Sum+Diff)//2
  q = Sum-p
  e=65537
  phi=(p-1)*(q-1)
  d= inverse(e,phi)
  flag=long_to_bytes(pow(ct,d,n))
  print(flag)
  ```
  **Flag**: inctfj{good_game_on_roots}

