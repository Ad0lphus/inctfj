title: Fl!p3
id: 1046
category: Crypto
difficulty: Medium
content: |
  **Author**: Pavani

  1. If you want flag,you must have ``admin=yes`` in place of ``admin=no!`` 
  2. Which means, you have to change last three bits to get the flag.
  3. Use `xor` operation between nth block of ct,pt and n-1th block of ct.  (here change bits of IV to change bits of pt(admin=no!)"
  4. change bits of n-1th block in such a way that would give ``admin=yes`` in plaintext(pt). 

  ```python=
  from pwn import *
  host,port = "gc1.eng.run",32041
  io = remote(host,port)
  io.recvline()
  ct = io.recvline()[len("auth_cookie =  "):-1]
  ct = ct.decode()
  ct = bytes.fromhex(ct)
  ct1 = ct[:16]
  ct1 = list(ct1)
  ct1[8] = ct1[8]^ ord('!') ^ ord('s')
  ct1[7] = ct1[7]^ ord('o') ^ ord('e')
  ct1[6] = ct1[6]^ ord('n') ^ ord('y')
  ct1 = bytes(ct1)
  ct = (ct1+ct[16:]).hex()
  io.recvuntil(b"Input authorized information that is required to get the flag: ")
  io.sendline(ct.encode())
  io.sendline(ct.encode())
  io.recv()
  ```

  **Flag**: inctfj{fl1ppY_HaPpY_Tr33_fr13nds}

